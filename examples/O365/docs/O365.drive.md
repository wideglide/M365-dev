<a id="O365.drive"></a>

# O365.drive

<a id="O365.drive.SIZE_THERSHOLD"></a>

#### SIZE\_THERSHOLD

2 MB

<a id="O365.drive.UPLOAD_SIZE_LIMIT_SIMPLE"></a>

#### UPLOAD\_SIZE\_LIMIT\_SIMPLE

4 MB

<a id="O365.drive.UPLOAD_SIZE_LIMIT_SESSION"></a>

#### UPLOAD\_SIZE\_LIMIT\_SESSION

60 MB

<a id="O365.drive.CHUNK_SIZE_BASE"></a>

#### CHUNK\_SIZE\_BASE

320 Kb

<a id="O365.drive.DownloadableMixin"></a>

## DownloadableMixin Objects

```python
class DownloadableMixin()
```

<a id="O365.drive.DownloadableMixin.download"></a>

#### download

```python
def download(to_path: Union[None, str, Path] = None,
             name: str = None,
             chunk_size: Union[str, int] = "auto",
             convert_to_pdf: bool = False,
             output: Optional[BytesIO] = None)
```

Downloads this file to the local drive. Can download the

file in chunks with multiple requests to the server.

**Arguments**:

- `to_path` (`str or Path`): a path to store the downloaded file
- `name` (`str`): the name you want the stored file to have.
- `chunk_size` (`int`): number of bytes to retrieve from
each api call to the server. if auto, files bigger than
SIZE_THERSHOLD will be chunked (into memory, will be
however only 1 request)
- `convert_to_pdf` (`bool`): will try to download the converted pdf
if file extension in ALLOWED_PDF_EXTENSIONS
- `output` (`BytesIO`): (optional) an opened io object to write to.
if set, the to_path and name will be ignored

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.CopyOperation"></a>

## CopyOperation Objects

```python
class CopyOperation(ApiComponent)
```

https://github.com/OneDrive/onedrive-api-docs/issues/762

<a id="O365.drive.CopyOperation.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, target=None, **kwargs)
```

**Arguments**:

- `parent` (`Drive`): parent for this operation i.e. the source of the copied item
- `con` (`Connection`): connection to use if no parent specified
- `target` (`Drive`): The target drive for the copy operation
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)
- `monitor_url` (`str`): 
- `item_id` (`str`): 

<a id="O365.drive.CopyOperation.check_status"></a>

#### check\_status

```python
def check_status(delay=0)
```

Checks the api endpoint in a loop

**Arguments**:

- `delay`: number of seconds to wait between api calls.
Note Connection 'requests_delay' also apply.

**Returns**:

`tuple(str, float)`: tuple of status and percentage complete

<a id="O365.drive.CopyOperation.get_item"></a>

#### get\_item

```python
def get_item()
```

Returns the item copied

**Returns**:

`DriveItem`: Copied Item

<a id="O365.drive.DriveItemVersion"></a>

## DriveItemVersion Objects

```python
class DriveItemVersion(ApiComponent, DownloadableMixin)
```

A version of a DriveItem

<a id="O365.drive.DriveItemVersion.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, **kwargs)
```

Version of DriveItem

**Arguments**:

- `parent` (`DriveItem`): parent for this operation
- `con` (`Connection`): connection to use if no parent specified
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)

<a id="O365.drive.DriveItemVersion.restore"></a>

#### restore

```python
def restore()
```

Restores this DriveItem Version.

You can not restore the current version (last one).

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItemVersion.download"></a>

#### download

```python
def download(to_path: Union[None, str, Path] = None,
             name: str = None,
             chunk_size: Union[str, int] = 'auto',
             convert_to_pdf: bool = False,
             output: Optional[BytesIO] = None)
```

Downloads this version.

You can not download the current version (last one).

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItemPermission"></a>

## DriveItemPermission Objects

```python
class DriveItemPermission(ApiComponent)
```

A Permission representation for a DriveItem

<a id="O365.drive.DriveItemPermission.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, **kwargs)
```

Permissions for DriveItem

**Arguments**:

- `parent` (`DriveItem`): parent for this operation
- `con` (`Connection`): connection to use if no parent specified
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)

<a id="O365.drive.DriveItemPermission.update_roles"></a>

#### update\_roles

```python
def update_roles(roles='view')
```

Updates the roles of this permission

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItemPermission.delete"></a>

#### delete

```python
def delete()
```

Deletes this permission. Only permissions that are not

inherited can be deleted.

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItem"></a>

## DriveItem Objects

```python
class DriveItem(ApiComponent)
```

A DriveItem representation. Groups all functionality

<a id="O365.drive.DriveItem.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, **kwargs)
```

Create a DriveItem

**Arguments**:

- `parent` (`Drive or drive.Folder`): parent for this operation
- `con` (`Connection`): connection to use if no parent specified
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)

<a id="O365.drive.DriveItem.is_folder"></a>

#### is\_folder

```python
@property
def is_folder()
```

Returns if this DriveItem is a Folder

<a id="O365.drive.DriveItem.is_file"></a>

#### is\_file

```python
@property
def is_file()
```

Returns if this DriveItem is a File

<a id="O365.drive.DriveItem.is_image"></a>

#### is\_image

```python
@property
def is_image()
```

Returns if this DriveItem is a Image

<a id="O365.drive.DriveItem.is_photo"></a>

#### is\_photo

```python
@property
def is_photo()
```

Returns if this DriveItem is a Photo

<a id="O365.drive.DriveItem.get_parent"></a>

#### get\_parent

```python
def get_parent()
```

the parent of this DriveItem

**Returns**:

`Drive or drive.Folder`: Parent of this item

<a id="O365.drive.DriveItem.get_drive"></a>

#### get\_drive

```python
def get_drive()
```

Returns this item drive

**Returns**:

`Drive or None`: Drive of this item

<a id="O365.drive.DriveItem.get_thumbnails"></a>

#### get\_thumbnails

```python
def get_thumbnails(size=None)
```

Returns this Item Thumbnails. Thumbnails are not supported on

SharePoint Server 2016.

**Arguments**:

- `size`: request only the specified size: ej: "small",
Custom 300x400 px: "c300x400", Crop: "c300x400_Crop"

**Returns**:

`dict`: Thumbnail Data

<a id="O365.drive.DriveItem.update"></a>

#### update

```python
def update(**kwargs)
```

Updates this item

**Arguments**:

- `kwargs`: all the properties to be updated.
only name and description are allowed at the moment.

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItem.delete"></a>

#### delete

```python
def delete()
```

Moves this item to the Recycle Bin

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItem.move"></a>

#### move

```python
def move(target)
```

Moves this DriveItem to another Folder.

Can't move between different Drives.

**Arguments**:

- `target` (`drive.Folder or DriveItem or str`): a Folder, Drive item or Item Id string.
If it's a drive the item will be moved to the root folder.

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.DriveItem.copy"></a>

#### copy

```python
def copy(target=None, name=None)
```

Asynchronously creates a copy of this DriveItem and all it's

child elements.

**Arguments**:

- `target` (`drive.Folder or Drive`): target location to move to.
If it's a drive the item will be moved to the root folder.
If it's None, the target is the parent of the item being copied i.e. item will be copied
into the same location.
- `name`: a new name for the copy.

<a id="O365.drive.DriveItem.get_versions"></a>

#### get\_versions

```python
def get_versions()
```

Returns a list of available versions for this item

**Returns**:

`list[DriveItemVersion]`: list of versions

<a id="O365.drive.DriveItem.get_version"></a>

#### get\_version

```python
def get_version(version_id)
```

Returns a version for specified id

**Returns**:

`DriveItemVersion`: a version object of specified id

<a id="O365.drive.DriveItem.share_with_link"></a>

#### share\_with\_link

```python
def share_with_link(share_type='view',
                    share_scope='anonymous',
                    share_password=None,
                    share_expiration_date=None)
```

Creates or returns a link you can share with others

**Arguments**:

- `share_type` (`str`): 'view' to allow only view access,
'edit' to allow editions, and
'embed' to allow the DriveItem to be embedded
- `share_scope` (`str`): 'anonymous': anyone with the link can access.
'organization' Only organization members can access
- `share_password` (`str`): sharing link password that is set by the creator. Optional.
- `share_expiration_date` (`str`): format of yyyy-MM-dd (e.g., 2022-02-14) that indicates the expiration date of the permission. Optional.

**Returns**:

`DriveItemPermission`: link to share

<a id="O365.drive.DriveItem.share_with_invite"></a>

#### share\_with\_invite

```python
def share_with_invite(recipients,
                      require_sign_in=True,
                      send_email=True,
                      message=None,
                      share_type='view')
```

Sends an invitation to access or edit this DriveItem

**Arguments**:

- `recipients` (`list[str] or list[Contact] or str or Contact`): a string or Contact or a list of the former
representing recipients of this invitation
- `require_sign_in` (`bool`): if True the recipients
invited will need to log in to view the contents
- `send_email` (`bool`): if True an email will be send to the recipients
- `message` (`str`): the body text of the message emailed
- `share_type` (`str`): 'view': will allow to read the contents.
'edit' will allow to modify the contents

**Returns**:

`DriveItemPermission`: link to share

<a id="O365.drive.DriveItem.get_permissions"></a>

#### get\_permissions

```python
def get_permissions()
```

Returns a list of DriveItemPermissions with the

permissions granted for this DriveItem.

**Returns**:

`list[DriveItemPermission]`: List of Permissions

<a id="O365.drive.File"></a>

## File Objects

```python
class File(DriveItem, DownloadableMixin)
```

A File

<a id="O365.drive.File.extension"></a>

#### extension

```python
@property
def extension()
```

The suffix of the file name.


<a id="O365.drive.Image"></a>

## Image Objects

```python
class Image(File)
```

An Image

<a id="O365.drive.Image.dimensions"></a>

#### dimensions

```python
@property
def dimensions()
```

Dimension of the Image

**Returns**:

`str`: width x height

<a id="O365.drive.Photo"></a>

## Photo Objects

```python
class Photo(Image)
```

Photo Object. Inherits from Image but has more attributes

<a id="O365.drive.Folder"></a>

## Folder Objects

```python
class Folder(DriveItem)
```

A Folder inside a Drive

<a id="O365.drive.Folder.get_items"></a>

#### get\_items

```python
def get_items(limit=None, *, query=None, order_by=None, batch=None)
```

Returns generator all the items inside this folder

**Arguments**:

- `limit` (`int`): max no. of folders to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: items in this folder

<a id="O365.drive.Folder.get_child_folders"></a>

#### get\_child\_folders

```python
def get_child_folders(limit=None, *, query=None, order_by=None, batch=None)
```

Returns all the folders inside this folder

**Arguments**:

- `limit` (`int`): max no. of folders to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: folder items in this folder

<a id="O365.drive.Folder.create_child_folder"></a>

#### create\_child\_folder

```python
def create_child_folder(name, description=None)
```

Creates a Child Folder

**Arguments**:

- `name` (`str`): the name of the new child folder
- `description` (`str`): the description of the new child folder

**Returns**:

`drive.Folder`: newly created folder

<a id="O365.drive.Folder.download_contents"></a>

#### download\_contents

```python
def download_contents(to_folder=None)
```

This will download each file and folder sequentially.

Caution when downloading big folder structures

**Arguments**:

- `to_folder` (`drive.Folder`): folder where to store the contents

<a id="O365.drive.Folder.search"></a>

#### search

```python
def search(search_text, limit=None, *, query=None, order_by=None, batch=None)
```

Search for DriveItems under this folder

The search API uses a search service under the covers,
which requires indexing of content.

As a result, there will be some time between creation of an item
and when it will appear in search results.

**Arguments**:

- `search_text` (`str`): The query text used to search for items.
Values may be matched across several fields including filename,
metadata, and file content.
- `limit` (`int`): max no. of folders to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: items in this folder matching search

<a id="O365.drive.Folder.upload_file"></a>

#### upload\_file

```python
def upload_file(item,
                item_name=None,
                chunk_size=DEFAULT_UPLOAD_CHUNK_SIZE,
                upload_in_chunks=False,
                stream=None,
                stream_size=None,
                conflict_handling=None,
                file_created_date_time: str = None,
                file_last_modified_date_time: str = None)
```

Uploads a file

**Arguments**:

- `item` (`str or Path`): path to the item you want to upload
- `item_name` (`str or Path`): name of the item on the server. None to use original name
- `chunk_size`: Only applies if file is bigger than 4MB or upload_in_chunks is True.
Chunk size for uploads. Must be a multiple of 327.680 bytes
- `upload_in_chunks`: force the method to upload the file in chunks
- `stream` (`io.BufferedIOBase`): (optional) an opened io object to read into.
if set, the to_path and name will be ignored
- `stream_size` (`int`): size of stream, required if using stream
- `conflict_handling` (`str`): How to handle conflicts.
NOTE: works for chunk upload only (>4MB or upload_in_chunks is True)
None to use default (overwrite). Options: fail | replace | rename
- `file_created_date_time`: allow to force file created date time while uploading
- `file_last_modified_date_time`: allow to force file last modified date time while uploading

**Returns**:

`DriveItem`: uploaded file

<a id="O365.drive.Drive"></a>

## Drive Objects

```python
class Drive(ApiComponent)
```

A Drive representation.
A Drive is a Container of Folders and Files and act as a root item

<a id="O365.drive.Drive.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, **kwargs)
```

Create a drive representation

**Arguments**:

- `parent` (`Drive or Storage`): parent for this operation
- `con` (`Connection`): connection to use if no parent specified
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)

<a id="O365.drive.Drive.get_root_folder"></a>

#### get\_root\_folder

```python
def get_root_folder()
```

Returns the Root Folder of this drive

**Returns**:

`DriveItem`: Root Folder

<a id="O365.drive.Drive.get_items"></a>

#### get\_items

```python
def get_items(limit=None, *, query=None, order_by=None, batch=None)
```

Returns a collection of drive items from the root folder

**Arguments**:

- `limit` (`int`): max no. of items to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: items in this folder

<a id="O365.drive.Drive.get_child_folders"></a>

#### get\_child\_folders

```python
def get_child_folders(limit=None, *, query=None, order_by=None, batch=None)
```

Returns all the folders inside this folder

**Arguments**:

- `limit` (`int`): max no. of folders to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: folder items in this folder

<a id="O365.drive.Drive.get_recent"></a>

#### get\_recent

```python
def get_recent(limit=None, *, query=None, order_by=None, batch=None)
```

Returns a collection of recently used DriveItems

**Arguments**:

- `limit` (`int`): max no. of items to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: items in this folder

<a id="O365.drive.Drive.get_shared_with_me"></a>

#### get\_shared\_with\_me

```python
def get_shared_with_me(limit=None,
                       allow_external=False,
                       *,
                       query=None,
                       order_by=None,
                       batch=None)
```

Returns a collection of DriveItems shared with me

**Arguments**:

- `limit` (`int`): max no. of items to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.
- `allow_external` (`bool`): includes items shared from external tenants

**Returns**:

`generator of DriveItem or Pagination`: items in this folder

<a id="O365.drive.Drive.get_item"></a>

#### get\_item

```python
def get_item(item_id)
```

Returns a DriveItem by it's Id

**Returns**:

`DriveItem`: one item

<a id="O365.drive.Drive.get_item_by_path"></a>

#### get\_item\_by\_path

```python
def get_item_by_path(item_path)
```

Returns a DriveItem by it's absolute path: /path/to/file

**Returns**:

`DriveItem`: one item

<a id="O365.drive.Drive.get_special_folder"></a>

#### get\_special\_folder

```python
def get_special_folder(name)
```

Returns the specified Special Folder

**Returns**:

`drive.Folder`: a special Folder

<a id="O365.drive.Drive.refresh"></a>

#### refresh

```python
def refresh()
```

Updates this drive with data from the server

**Returns**:

`bool`: Success / Failure

<a id="O365.drive.Drive.search"></a>

#### search

```python
def search(search_text, limit=None, *, query=None, order_by=None, batch=None)
```

Search for DriveItems under this drive.

Your app can search more broadly to include items shared with the
current user.

To broaden the search scope, use this search instead the Folder Search.

The search API uses a search service under the covers, which requires
indexing of content.

As a result, there will be some time between creation of an
item and when it will appear in search results.

**Arguments**:

- `search_text` (`str`): The query text used to search for items.
Values may be matched across several fields including filename,
metadata, and file content.
- `limit` (`int`): max no. of items to get. Over 999 uses batch.
- `query` (`Query or str`): applies a OData filter to the request
- `order_by` (`Query or str`): orders the result set based on this condition
- `batch` (`int`): batch size, retrieves items in
batches allowing to retrieve more items than the limit.

**Returns**:

`generator of DriveItem or Pagination`: items in this folder matching search

<a id="O365.drive.Storage"></a>

## Storage Objects

```python
class Storage(ApiComponent)
```

Parent Class that holds drives

<a id="O365.drive.Storage.drive_constructor"></a>

#### drive\_constructor

:meta private:

<a id="O365.drive.Storage.__init__"></a>

#### \_\_init\_\_

```python
def __init__(*, parent=None, con=None, **kwargs)
```

Create a storage representation

**Arguments**:

- `parent` (`Account`): parent for this operation
- `con` (`Connection`): connection to use if no parent specified
- `protocol` (`Protocol`): protocol to use if no parent specified
(kwargs)
- `main_resource` (`str`): use this resource instead of parent resource
(kwargs)

<a id="O365.drive.Storage.get_default_drive"></a>

#### get\_default\_drive

```python
def get_default_drive(request_drive=False)
```

Returns a Drive instance

**Arguments**:

- `request_drive`: True will make an api call to retrieve the drive
data

**Returns**:

`Drive`: default One Drive

<a id="O365.drive.Storage.get_drive"></a>

#### get\_drive

```python
def get_drive(drive_id)
```

Returns a Drive instance

**Arguments**:

- `drive_id`: the drive_id to be retrieved

**Returns**:

`Drive`: Drive for the id

<a id="O365.drive.Storage.get_drives"></a>

#### get\_drives

```python
def get_drives()
```

Returns a collection of drives

